from __future__ import division
from numpy import sqrt,log,exp,abs,cos
from numba import jit
@jit
def get_xN( M,M_h,x_bj,z_h,Q,T_t,xi,zeta,delta_k_t,k_i_t,M_ki,M_kf,theta_H,theta_delta_k,theta_ki): return (2*Q*x_bj/(Q + sqrt(4*M**2*x_bj**2 + Q**2)))
@jit
def get_zN( M,M_h,x_bj,z_h,Q,T_t,xi,zeta,delta_k_t,k_i_t,M_ki,M_kf,theta_H,theta_delta_k,theta_ki): return (Q*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))/((Q + sqrt(4*M**2*x_bj**2 + Q**2))*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)))
@jit
def get_R01( M,M_h,x_bj,z_h,Q,T_t,xi,zeta,delta_k_t,k_i_t,M_ki,M_kf,theta_H,theta_delta_k,theta_ki): return (-M_ki**2/Q**2)
@jit
def get_R02( M,M_h,x_bj,z_h,Q,T_t,xi,zeta,delta_k_t,k_i_t,M_ki,M_kf,theta_H,theta_delta_k,theta_ki): return (M_kf**2/Q**2)
@jit
def get_R03( M,M_h,x_bj,z_h,Q,T_t,xi,zeta,delta_k_t,k_i_t,M_ki,M_kf,theta_H,theta_delta_k,theta_ki): return (delta_k_t**2/Q**2)
@jit
def get_R41( M,M_h,x_bj,z_h,Q,T_t,xi,zeta,delta_k_t,k_i_t,M_ki,M_kf,theta_H,theta_delta_k,theta_ki): return (-M_ki**2*Q*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))/(zeta*(Q + sqrt(4*M**2*x_bj**2 + Q**2))*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)*abs(-M_kf**2*Q*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))/(zeta*(Q + sqrt(4*M**2*x_bj**2 + Q**2))*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)) + M_kf**2 - Q**4*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))**2/(zeta**2*(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)**2) + Q**3*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))/(zeta*(Q + sqrt(4*M**2*x_bj**2 + Q**2))*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)) + Q**2*T_t**2*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))**2/(zeta**2*(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)**2) - 2*Q*T_t*delta_k_t*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))*cos(theta_H - theta_delta_k)/(zeta*(Q + sqrt(4*M**2*x_bj**2 + Q**2))*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)) + delta_k_t**2)))
@jit
def get_R42( M,M_h,x_bj,z_h,Q,T_t,xi,zeta,delta_k_t,k_i_t,M_ki,M_kf,theta_H,theta_delta_k,theta_ki): return (M_kf**2*Q*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))/(zeta*(Q + sqrt(4*M**2*x_bj**2 + Q**2))*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)*abs(-M_kf**2*Q*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))/(zeta*(Q + sqrt(4*M**2*x_bj**2 + Q**2))*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)) + M_kf**2 - Q**4*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))**2/(zeta**2*(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)**2) + Q**3*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))/(zeta*(Q + sqrt(4*M**2*x_bj**2 + Q**2))*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)) + Q**2*T_t**2*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))**2/(zeta**2*(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)**2) - 2*Q*T_t*delta_k_t*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))*cos(theta_H - theta_delta_k)/(zeta*(Q + sqrt(4*M**2*x_bj**2 + Q**2))*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)) + delta_k_t**2)))
@jit
def get_R43( M,M_h,x_bj,z_h,Q,T_t,xi,zeta,delta_k_t,k_i_t,M_ki,M_kf,theta_H,theta_delta_k,theta_ki): return (Q*delta_k_t**2*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))/(zeta*(Q + sqrt(4*M**2*x_bj**2 + Q**2))*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)*abs(-M_kf**2*Q*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))/(zeta*(Q + sqrt(4*M**2*x_bj**2 + Q**2))*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)) + M_kf**2 - Q**4*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))**2/(zeta**2*(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)**2) + Q**3*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))/(zeta*(Q + sqrt(4*M**2*x_bj**2 + Q**2))*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)) + Q**2*T_t**2*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))**2/(zeta**2*(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)**2) - 2*Q*T_t*delta_k_t*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))*cos(theta_H - theta_delta_k)/(zeta*(Q + sqrt(4*M**2*x_bj**2 + Q**2))*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)) + delta_k_t**2)))
@jit
def get_R1( M,M_h,x_bj,z_h,Q,T_t,xi,zeta,delta_k_t,k_i_t,M_ki,M_kf,theta_H,theta_delta_k,theta_ki): return (2*Q**2*x_bj*zeta*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)*(M_h**2*Q**2*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))**2/(zeta**2*(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)**2) + M_kf**2*Q**2*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))**2/((Q + sqrt(4*M**2*x_bj**2 + Q**2))**2*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)**2) + Q**2*delta_k_t**2*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))**2/((Q + sqrt(4*M**2*x_bj**2 + Q**2))**2*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)**2))/(xi*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))*(Q**6*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))**2/((Q + sqrt(4*M**2*x_bj**2 + Q**2))**2*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)**2) + 4*Q**5*T_t*k_i_t*x_bj*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))**2*cos(theta_H - theta_ki)/(xi*(Q + sqrt(4*M**2*x_bj**2 + Q**2))**3*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)**2) + 4*Q**2*x_bj**2*(M_h**2 + Q**2*T_t**2*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))**2/((Q + sqrt(4*M**2*x_bj**2 + Q**2))**2*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)**2))*abs(M_ki**2 - delta_k_t**2)/(xi**2*(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2))))
def get_R1_adjust( M,M_h,x_bj,z_h,Q,T_t,xi,zeta,delta_k_t,k_i_t,M_ki2,M_kf,theta_H,theta_delta_k,theta_ki): return (2*Q**2*x_bj*zeta*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)*(M_h**2*Q**2*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))**2/(zeta**2*(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)**2) + M_kf**2*Q**2*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))**2/((Q + sqrt(4*M**2*x_bj**2 + Q**2))**2*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)**2) + Q**2*delta_k_t**2*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))**2/((Q + sqrt(4*M**2*x_bj**2 + Q**2))**2*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)**2))/(xi*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))*(Q**6*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))**2/((Q + sqrt(4*M**2*x_bj**2 + Q**2))**2*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)**2) + 4*Q**5*T_t*k_i_t*x_bj*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))**2*cos(theta_H - theta_ki)/(xi*(Q + sqrt(4*M**2*x_bj**2 + Q**2))**3*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)**2) + 4*Q**2*x_bj**2*(M_h**2 + Q**2*T_t**2*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))**2/((Q + sqrt(4*M**2*x_bj**2 + Q**2))**2*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)**2))*(k_i_t**2 - M_ki2)/(xi**2*(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2))))
@jit
def get_R2( M,M_h,x_bj,z_h,Q,T_t,xi,zeta,delta_k_t,k_i_t,M_ki,M_kf,theta_H,theta_delta_k,theta_ki): return (zeta*(Q + sqrt(4*M**2*x_bj**2 + Q**2))*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)*abs(M_kf**2 - Q*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))*(M_kf**2 + Q**3*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))/(zeta*(Q + sqrt(4*M**2*x_bj**2 + Q**2))*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)) - Q**2 - Q*T_t**2*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))/(zeta*(Q + sqrt(4*M**2*x_bj**2 + Q**2))*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)) + 2*T_t*delta_k_t*cos(theta_H - theta_delta_k))/(zeta*(Q + sqrt(4*M**2*x_bj**2 + Q**2))*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)) + delta_k_t**2)/(Q**3*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))))
@jit
def get_R3( M,M_h,x_bj,z_h,Q,T_t,xi,zeta,delta_k_t,k_i_t,M_ki,M_kf,theta_H,theta_delta_k,theta_ki): return ((1/2)*xi*zeta*(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)*abs(2*Q**4*x_bj*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))*(Q**2*T_t**2*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))**2/(zeta**2*(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)**2) - 2*Q*T_t*delta_k_t*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))*cos(theta_H - theta_delta_k)/(zeta*(Q + sqrt(4*M**2*x_bj**2 + Q**2))*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)) + 2*Q*T_t*k_i_t*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))*cos(theta_H - theta_ki)/(zeta*(Q + sqrt(4*M**2*x_bj**2 + Q**2))*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)) + delta_k_t**2 - 2*delta_k_t*k_i_t*cos(theta_delta_k - theta_ki) + k_i_t**2)/(xi*zeta*(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)) + (-Q**2*(Q*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))/(zeta*(Q + sqrt(4*M**2*x_bj**2 + Q**2))*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)) - 1) + 2*Q*x_bj*abs(M_ki**2 - delta_k_t**2)/(xi*(Q + sqrt(4*M**2*x_bj**2 + Q**2))))*(2*Q**4*x_bj*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))/(xi*zeta*(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)) - Q**3*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))/(zeta*(Q + sqrt(4*M**2*x_bj**2 + Q**2))*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)) + 2*Q*x_bj*(M_kf**2 + Q**2*T_t**2*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))**2/(zeta**2*(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)**2) - 2*Q*T_t*delta_k_t*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))*cos(theta_H - theta_delta_k)/(zeta*(Q + sqrt(4*M**2*x_bj**2 + Q**2))*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)) + delta_k_t**2)/(xi*(Q + sqrt(4*M**2*x_bj**2 + Q**2)))))/(Q**6*x_bj*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))))
@jit
def get_R1p( M,M_h,x_bj,z_h,Q,T_t,xi,zeta,delta_k_t,k_i_t,M_ki,M_kf,theta_H,theta_delta_k,theta_ki): return ((1/4)*(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)*(4*M**2*Q**2*x_bj**2*(M_h**2 + Q**2*T_t**2*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))**2/((Q + sqrt(4*M**2*x_bj**2 + Q**2))**2*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)**2))/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**6*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))**2/((Q + sqrt(4*M**2*x_bj**2 + Q**2))**2*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)**2))/(Q**6*x_bj*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))))
@jit
def get_yp( M,M_h,x_bj,z_h,Q,T_t,xi,zeta,delta_k_t,k_i_t,M_ki,M_kf,theta_H,theta_delta_k,theta_ki): return ((1/2)*log((1/4)*(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2/(M**2*x_bj**2)))
@jit
def get_yh( M,M_h,x_bj,z_h,Q,T_t,xi,zeta,delta_k_t,k_i_t,M_ki,M_kf,theta_H,theta_delta_k,theta_ki): return (-log(Q) - log(Q*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))/((Q + sqrt(4*M**2*x_bj**2 + Q**2))*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4))) + (1/2)*log(M_h**2 + Q**2*T_t**2*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))**2/((Q + sqrt(4*M**2*x_bj**2 + Q**2))**2*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)**2)))
# yh from the other solution of z_h
@jit
def get_yh_target( M,M_h,x_bj,z_h,Q,T_t,xi,zeta,delta_k_t,k_i_t,M_ki,M_kf,theta_H,theta_delta_k,theta_ki): return (-log(Q) - log(Q*(Q**4*z_h - sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))/((Q + sqrt(4*M**2*x_bj**2 + Q**2))*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4))) + (1/2)*log(M_h**2 + Q**2*T_t**2*(Q**4*z_h - sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))**2/((Q + sqrt(4*M**2*x_bj**2 + Q**2))**2*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)**2)))
@jit
def get_yi( M,M_h,x_bj,z_h,Q,T_t,xi,zeta,delta_k_t,k_i_t,M_ki,M_kf,theta_H,theta_delta_k,theta_ki): return (log((1/2)*xi*(Q + sqrt(4*M**2*x_bj**2 + Q**2))/(x_bj*sqrt(abs(M_ki**2 - delta_k_t**2)))))
@jit
def get_yf( M,M_h,x_bj,z_h,Q,T_t,xi,zeta,delta_k_t,k_i_t,M_ki,M_kf,theta_H,theta_delta_k,theta_ki): return (-log(Q) - log(Q*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))/(zeta*(Q + sqrt(4*M**2*x_bj**2 + Q**2))*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4))) + (1/2)*log(abs(M_kf**2 + Q**2*T_t**2*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))**2/(zeta**2*(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)**2) - 2*Q*T_t*delta_k_t*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))*cos(theta_H - theta_delta_k)/(zeta*(Q + sqrt(4*M**2*x_bj**2 + Q**2))*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)) + delta_k_t**2)))
@jit
def get_Htmax( M,M_h,x_bj,z_h,Q,T_t,xi,zeta,delta_k_t,k_i_t,M_ki,M_kf,theta_H,theta_delta_k,theta_ki): return ((1/2)*sqrt(2)*sqrt(Q + sqrt(4*M**2*x_bj**2 + Q**2))*sqrt(-4*M**2*M_h**2*Q**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*Q**5*x_bj**2*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))/((Q + sqrt(4*M**2*x_bj**2 + Q**2))**3*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)) + 2*M_h**2*Q**4*x_bj*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))/((Q + sqrt(4*M**2*x_bj**2 + Q**2))**2*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)) - 2*M_h**2*Q**3*x_bj/(Q + sqrt(4*M**2*x_bj**2 + Q**2)) + 2*Q**7*x_bj*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))**2/((Q + sqrt(4*M**2*x_bj**2 + Q**2))**3*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)**2) - 2*Q**6*x_bj*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))/((Q + sqrt(4*M**2*x_bj**2 + Q**2))**2*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)) - Q**6*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))**2/((Q + sqrt(4*M**2*x_bj**2 + Q**2))**2*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)**2) + Q**5*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))/((Q + sqrt(4*M**2*x_bj**2 + Q**2))*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)))/(sqrt(Q)*sqrt(x_bj)*sqrt(2*M**2*Q*x_bj/(Q + sqrt(4*M**2*x_bj**2 + Q**2)) + Q**2)))
@jit
def get_rap( M,M_h,x_bj,z_h,Q,T_t,xi,zeta,delta_k_t,k_i_t,M_ki,M_kf,theta_H,theta_delta_k,theta_ki): return ((1/2)*log((M_h**2 + Q**2*T_t**2*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))**2/((Q + sqrt(4*M**2*x_bj**2 + Q**2))**2*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)**2))*(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)**2/(Q**4*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))**2)))
@jit
def get_qT2( M,M_h,x_bj,z_h,Q,T_t,xi,zeta,delta_k_t,k_i_t,M_ki,M_kf,theta_H,theta_delta_k,theta_ki): return (Q**8*T_t**2*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))**4*(4*M**2*Q**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**2)**2/((Q + sqrt(4*M**2*x_bj**2 + Q**2))**4*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)**4*(16*M**2*Q**10*T_t**2*x_bj**2*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))**4/((Q + sqrt(4*M**2*x_bj**2 + Q**2))**6*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)**4) + (4*M**2*M_h**2*Q**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + 4*M**2*Q**4*T_t**2*x_bj**2*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))**2/((Q + sqrt(4*M**2*x_bj**2 + Q**2))**4*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)**2) - Q**6*(Q**4*z_h + sqrt(-16*M**4*M_h**2*Q**2*T_t**2*x_bj**4/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 - 4*M**2*M_h**2*Q**4*x_bj**2 + Q**8*z_h**2))**2/((Q + sqrt(4*M**2*x_bj**2 + Q**2))**2*(4*M**2*Q**2*T_t**2*x_bj**2/(Q + sqrt(4*M**2*x_bj**2 + Q**2))**2 + Q**4)**2))**2)))
